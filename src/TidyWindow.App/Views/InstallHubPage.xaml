<Page x:Class="TidyWindow.App.Views.InstallHubPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="clr-namespace:TidyWindow.App.Converters"
      xmlns:controls="clr-namespace:TidyWindow.App.Views"
      xmlns:viewModels="clr-namespace:TidyWindow.App.ViewModels"
      xmlns:views="clr-namespace:TidyWindow.App.Views"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
      mc:Ignorable="d"
      Title="Install hub"
      Background="Transparent">
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="InstallHubResources.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <CubicEase x:Key="InstallHubEaseIn" EasingMode="EaseInOut"/>
            <CubicEase x:Key="InstallHubEaseOut" EasingMode="EaseOut"/>

            <LinearGradientBrush x:Key="InstallOverlayBackdropBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#B3121E33" Offset="0"/>
            <GradientStop Color="#E62F3D5E" Offset="1"/>
            </LinearGradientBrush>

            <LinearGradientBrush x:Key="InstallOverlayPanelBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#101B33" Offset="0"/>
            <GradientStop Color="#0B1426" Offset="1"/>
            </LinearGradientBrush>

            <RadialGradientBrush x:Key="InstallOverlayPulseBrush" GradientOrigin="0.5,0.4" Center="0.5,0.5" RadiusX="0.9" RadiusY="0.9">
            <GradientStop Color="#557C3AED" Offset="0"/>
            <GradientStop Color="#06152C" Offset="1"/>
            </RadialGradientBrush>

            <DropShadowEffect x:Key="InstallOverlayShadowEffect"
                          Color="#050A18"
                          BlurRadius="34"
                          ShadowDepth="0"
                          Opacity="0.72"/>
            <SolidColorBrush x:Key="InstallOverlayAccentBrush" Color="#7C3AED"/>
            <SolidColorBrush x:Key="InstallOverlaySecondaryAccentBrush" Color="#38BDF8"/>
            <SolidColorBrush x:Key="InstallOverlaySuccessBrush" Color="#22C55E"/>

            <CubicEase x:Key="InstallOverlayEaseIn" EasingMode="EaseInOut"/>
            <CubicEase x:Key="InstallOverlayEaseOut" EasingMode="EaseOut"/>

            <CubicEase x:Key="InstallPivotEaseIn" EasingMode="EaseOut"/>
            <CubicEase x:Key="InstallPivotEaseOut" EasingMode="EaseInOut"/>

            <Style x:Key="InstallHubPivotContentBaseStyle"
                   TargetType="FrameworkElement">
                <Setter Property="Opacity" Value="0"/>
                <Setter Property="Visibility" Value="Collapsed"/>
                <Setter Property="IsHitTestVisible" Value="False"/>
                <Setter Property="Panel.ZIndex" Value="0"/>
            </Style>

            <Style x:Key="InstallHubBundlesViewStyle"
                   TargetType="views:InstallHubBundlesView"
                   BasedOn="{StaticResource InstallHubPivotContentBaseStyle}">
                <Style.Triggers>
                    <DataTrigger Value="True">
                        <DataTrigger.Binding>
                            <Binding Path="DataContext.CurrentPivot"
                                     RelativeSource="{RelativeSource AncestorType={x:Type Page}}"
                                     Converter="{StaticResource EnumEqualsConverter}"
                                     ConverterParameter="{x:Static viewModels:CurrentInstallHubPivot.Bundles}"/>
                        </DataTrigger.Binding>
                        <Setter Property="Panel.ZIndex" Value="1"/>
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsHitTestVisible">
                                        <DiscreteBooleanKeyFrame KeyTime="0" Value="True"/>
                                    </BooleanAnimationUsingKeyFrames>
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                     To="1"
                                                     Duration="0:0:0.35"
                                                     EasingFunction="{StaticResource InstallPivotEaseIn}"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                     To="0"
                                                     Duration="0:0:0.35"
                                                     EasingFunction="{StaticResource InstallPivotEaseOut}"/>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsHitTestVisible">
                                        <DiscreteBooleanKeyFrame KeyTime="0" Value="False"/>
                                    </BooleanAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.35" Value="{x:Static Visibility.Collapsed}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.ExitActions>
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <Style x:Key="InstallHubCatalogViewStyle"
                   TargetType="views:InstallHubCatalogView"
                   BasedOn="{StaticResource InstallHubPivotContentBaseStyle}">
                <Style.Triggers>
                    <DataTrigger Value="True">
                        <DataTrigger.Binding>
                            <Binding Path="DataContext.CurrentPivot"
                                     RelativeSource="{RelativeSource AncestorType={x:Type Page}}"
                                     Converter="{StaticResource EnumEqualsConverter}"
                                     ConverterParameter="{x:Static viewModels:CurrentInstallHubPivot.Catalog}"/>
                        </DataTrigger.Binding>
                        <Setter Property="Panel.ZIndex" Value="1"/>
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsHitTestVisible">
                                        <DiscreteBooleanKeyFrame KeyTime="0" Value="True"/>
                                    </BooleanAnimationUsingKeyFrames>
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                     To="1"
                                                     Duration="0:0:0.35"
                                                     EasingFunction="{StaticResource InstallPivotEaseIn}"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                     To="0"
                                                     Duration="0:0:0.35"
                                                     EasingFunction="{StaticResource InstallPivotEaseOut}"/>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsHitTestVisible">
                                        <DiscreteBooleanKeyFrame KeyTime="0" Value="False"/>
                                    </BooleanAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.35" Value="{x:Static Visibility.Collapsed}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.ExitActions>
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <Style x:Key="InstallHubQueueViewStyle"
                   TargetType="views:InstallHubQueueView"
                   BasedOn="{StaticResource InstallHubPivotContentBaseStyle}">
                <Style.Triggers>
                    <DataTrigger Value="True">
                        <DataTrigger.Binding>
                            <Binding Path="DataContext.CurrentPivot"
                                     RelativeSource="{RelativeSource AncestorType={x:Type Page}}"
                                     Converter="{StaticResource EnumEqualsConverter}"
                                     ConverterParameter="{x:Static viewModels:CurrentInstallHubPivot.Queue}"/>
                        </DataTrigger.Binding>
                        <Setter Property="Panel.ZIndex" Value="1"/>
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsHitTestVisible">
                                        <DiscreteBooleanKeyFrame KeyTime="0" Value="True"/>
                                    </BooleanAnimationUsingKeyFrames>
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                     To="1"
                                                     Duration="0:0:0.35"
                                                     EasingFunction="{StaticResource InstallPivotEaseIn}"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                        <DataTrigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                     To="0"
                                                     Duration="0:0:0.35"
                                                     EasingFunction="{StaticResource InstallPivotEaseOut}"/>
                                    <BooleanAnimationUsingKeyFrames Storyboard.TargetProperty="IsHitTestVisible">
                                        <DiscreteBooleanKeyFrame KeyTime="0" Value="False"/>
                                    </BooleanAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility">
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.35" Value="{x:Static Visibility.Collapsed}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.ExitActions>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </Page.Resources>

    <Grid>
        <ScrollViewer Margin="32"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      HorizontalContentAlignment="Stretch"
                      PanningMode="VerticalOnly">
            <Grid MaxWidth="1360"
                  HorizontalAlignment="Center">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <controls:PageTitleBar Grid.Row="0"
                                       Title="Smart install hub"
                                       Subtitle="Curate developer bundles"
                                       IconGlyph="ðŸ“¦"
                                       Margin="0,0,0,28">
                    <controls:PageTitleBar.BodyContent>
                        <StackPanel>
                            <TextBlock Text="{Binding Headline}"
                                       Foreground="#E2E8F0"
                                       FontSize="14"
                                       FontWeight="SemiBold"
                                       TextWrapping="Wrap"/>
                            <TextBlock Text="Choose a pivot to focus on bundles, the catalog, or your install queue."
                                       Foreground="#94A3B8"
                                       FontSize="12"
                                       Margin="0,6,0,0"
                                       TextWrapping="Wrap"/>
                            <WrapPanel Margin="0,16,0,0"
                                       ItemHeight="Auto"
                                       ItemWidth="Auto"
                                       MinWidth="0">
                                <ToggleButton Content="Bundles"
                                              Margin="0,0,12,12"
                                              Style="{StaticResource InstallHubPivotButtonStyle}"
                                              Command="{Binding NavigatePivotCommand}"
                                              CommandParameter="{x:Static viewModels:CurrentInstallHubPivot.Bundles}"
                                              IsChecked="{Binding CurrentPivot, Converter={StaticResource EnumEqualsConverter}, ConverterParameter={x:Static viewModels:CurrentInstallHubPivot.Bundles}}"/>
                                <ToggleButton Content="Catalog"
                                              Margin="0,0,12,12"
                                              Style="{StaticResource InstallHubPivotButtonStyle}"
                                              Command="{Binding NavigatePivotCommand}"
                                              CommandParameter="{x:Static viewModels:CurrentInstallHubPivot.Catalog}"
                                              IsChecked="{Binding CurrentPivot, Converter={StaticResource EnumEqualsConverter}, ConverterParameter={x:Static viewModels:CurrentInstallHubPivot.Catalog}}"/>
                                <ToggleButton Content="Queue"
                                              Margin="0,0,12,12"
                                              Style="{StaticResource InstallHubPivotButtonStyle}"
                                              Command="{Binding NavigatePivotCommand}"
                                              CommandParameter="{x:Static viewModels:CurrentInstallHubPivot.Queue}"
                                              IsChecked="{Binding CurrentPivot, Converter={StaticResource EnumEqualsConverter}, ConverterParameter={x:Static viewModels:CurrentInstallHubPivot.Queue}}"/>
                            </WrapPanel>
                        </StackPanel>
                    </controls:PageTitleBar.BodyContent>
                </controls:PageTitleBar>

                <Grid Grid.Row="1">
                    <views:InstallHubBundlesView Style="{StaticResource InstallHubBundlesViewStyle}"/>
                    <views:InstallHubCatalogView Style="{StaticResource InstallHubCatalogViewStyle}"/>
                    <views:InstallHubQueueView Style="{StaticResource InstallHubQueueViewStyle}"/>
                </Grid>
            </Grid>
        </ScrollViewer>

        <ContentControl x:Name="InstallHubLoadingOverlay"
                        Panel.ZIndex="6"
                        Focusable="False"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch">
            <ContentControl.Style>
                <Style TargetType="ContentControl">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Setter Property="IsHitTestVisible" Value="False"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsLoading}" Value="True">
                            <Setter Property="Visibility" Value="Visible"/>
                            <Setter Property="IsHitTestVisible" Value="True"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </ContentControl.Style>
            <ContentControl.Template>
                <ControlTemplate TargetType="ContentControl">
                    <Grid x:Name="OverlayRoot"
                          Background="Transparent"
                          Visibility="Collapsed"
                          Opacity="0"
                          IsHitTestVisible="False">
                        <Grid Background="{StaticResource InstallOverlayBackdropBrush}">
                            <Border HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Padding="36,30"
                                    CornerRadius="28"
                                    Background="{StaticResource InstallOverlayPanelBrush}"
                                    BorderBrush="#1E2F4B"
                                    BorderThickness="1.5"
                                    Effect="{StaticResource InstallOverlayShadowEffect}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="240"/>
                                        <ColumnDefinition Width="24"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Grid Grid.Column="0"
                                          HorizontalAlignment="Center"
                                          VerticalAlignment="Center">
                                        <Grid Width="220"
                                              Height="220">
                                            <Ellipse Width="220"
                                                     Height="220"
                                                     Fill="#0C1A2E"
                                                     Stroke="#1C2D47"
                                                     StrokeThickness="1.5"/>
                                            <Ellipse Width="180"
                                                     Height="180"
                                                     Stroke="#243753"
                                                     StrokeThickness="1.2"
                                                     StrokeDashArray="12 18">
                                                <Ellipse.RenderTransform>
                                                    <RotateTransform x:Name="InstallOuterRingRotate"
                                                                     Angle="0"/>
                                                </Ellipse.RenderTransform>
                                            </Ellipse>
                                            <Ellipse Width="146"
                                                     Height="146"
                                                     Stroke="{StaticResource InstallOverlayAccentBrush}"
                                                     StrokeThickness="1.8"
                                                     StrokeDashArray="8 14"
                                                     Opacity="0.85">
                                                <Ellipse.RenderTransform>
                                                    <RotateTransform x:Name="InstallInnerRingRotate"
                                                                     Angle="0"/>
                                                </Ellipse.RenderTransform>
                                            </Ellipse>
                                            <Ellipse Width="112"
                                                     Height="112"
                                                     Fill="{StaticResource InstallOverlayPulseBrush}"
                                                     Opacity="0.6">
                                                <Ellipse.RenderTransform>
                                                    <ScaleTransform x:Name="InstallPulseScaleTransform"
                                                                    ScaleX="1"
                                                                    ScaleY="1"/>
                                                </Ellipse.RenderTransform>
                                            </Ellipse>
                                            <Grid Width="112"
                                                  Height="112"
                                                  RenderTransformOrigin="0.5,0.5">
                                                <Grid.RenderTransform>
                                                    <RotateTransform x:Name="InstallOrbitRotate"
                                                                     Angle="0"/>
                                                </Grid.RenderTransform>
                                                <Border Width="16"
                                                        Height="16"
                                                        CornerRadius="8"
                                                        Background="{StaticResource InstallOverlayAccentBrush}"
                                                        BorderBrush="#101A2C"
                                                        BorderThickness="1"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Top"
                                                        Margin="0,-6,0,0"/>
                                                <Border Width="20"
                                                        Height="20"
                                                        CornerRadius="10"
                                                        Background="{StaticResource InstallOverlaySecondaryAccentBrush}"
                                                        BorderBrush="#10283E"
                                                        BorderThickness="1"
                                                        HorizontalAlignment="Right"
                                                        VerticalAlignment="Center"
                                                        Margin="0,0,-8,0"/>
                                                <Border Width="12"
                                                        Height="12"
                                                        CornerRadius="6"
                                                        Background="{StaticResource InstallOverlaySuccessBrush}"
                                                        BorderBrush="#123522"
                                                        BorderThickness="1"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Bottom"
                                                        Margin="0,0,0,-8"/>
                                            </Grid>
                                        </Grid>
                                    </Grid>

                                    <Rectangle Grid.Column="1"
                                               Width="1"
                                               RadiusX="0.5"
                                               RadiusY="0.5"
                                               Fill="#1E314F"
                                               Opacity="0.45"/>

                                    <StackPanel Grid.Column="2"
                                                VerticalAlignment="Center">
                                        <TextBlock Text="Preparing install hub"
                                                   FontSize="22"
                                                   FontWeight="SemiBold"
                                                   Foreground="#F8FAFC"/>
                                        <TextBlock Text="Fetching catalog entries, syncing bundles, and measuring queue state..."
                                                   FontSize="13"
                                                   Foreground="#94A3B8"
                                                   Margin="0,6,0,0"
                                                   TextWrapping="Wrap"/>
                                        <StackPanel Margin="0,18,0,0">
                                            <StackPanel Orientation="Horizontal"
                                                        Margin="0,4,0,0">
                                                <Ellipse Width="6"
                                                         Height="6"
                                                         Fill="{StaticResource InstallOverlayAccentBrush}"
                                                         VerticalAlignment="Center"/>
                                                <TextBlock Text="Loading package definitions from the local cache"
                                                           Margin="10,0,0,0"
                                                           Foreground="#CBD5F5"
                                                           FontSize="12"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                        Margin="0,4,0,0">
                                                <Ellipse Width="6"
                                                         Height="6"
                                                         Fill="{StaticResource InstallOverlaySecondaryAccentBrush}"
                                                         VerticalAlignment="Center"/>
                                                <TextBlock Text="Evaluating saved bundle presets and queue state"
                                                           Margin="10,0,0,0"
                                                           Foreground="#CBD5F5"
                                                           FontSize="12"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal"
                                                        Margin="0,4,0,0">
                                                <Ellipse Width="6"
                                                         Height="6"
                                                         Fill="{StaticResource InstallOverlaySuccessBrush}"
                                                         VerticalAlignment="Center"/>
                                                <TextBlock Text="Reconciling in-flight operations before rendering the catalog"
                                                           Margin="10,0,0,0"
                                                           Foreground="#CBD5F5"
                                                           FontSize="12"/>
                                            </StackPanel>
                                        </StackPanel>
                                        <Border Height="6"
                                                CornerRadius="3"
                                                Background="#152339"
                                                Margin="0,22,0,0">
                                            <Grid ClipToBounds="True">
                                                <Rectangle x:Name="InstallProgressPulse"
                                                           Width="200"
                                                           Height="6"
                                                           Fill="{StaticResource InstallOverlaySecondaryAccentBrush}">
                                                    <Rectangle.RenderTransform>
                                                        <TranslateTransform x:Name="InstallProgressTranslate"
                                                                            X="-200"/>
                                                    </Rectangle.RenderTransform>
                                                </Rectangle>
                                            </Grid>
                                        </Border>
                                        <TextBlock Text="Hang tightâ€”UI unlocks as soon as the install queue is ready."
                                                   FontSize="12"
                                                   Foreground="#64748B"
                                                   Margin="0,14,0,0"
                                                   TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <DataTrigger Binding="{Binding Path=DataContext.IsLoading, RelativeSource={RelativeSource TemplatedParent}}"
                                     Value="True">
                            <Setter TargetName="OverlayRoot" Property="Visibility" Value="Visible"/>
                            <Setter TargetName="OverlayRoot" Property="IsHitTestVisible" Value="True"/>
                            <DataTrigger.EnterActions>
                                <BeginStoryboard x:Name="InstallOverlayFadeInStoryboard">
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="OverlayRoot"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="1"
                                                         Duration="0:0:0.45"
                                                         EasingFunction="{StaticResource InstallOverlayEaseIn}"/>
                                    </Storyboard>
                                </BeginStoryboard>
                                <BeginStoryboard x:Name="InstallOverlayMotionStoryboard">
                                    <Storyboard RepeatBehavior="Forever">
                                        <DoubleAnimation Storyboard.TargetName="InstallOuterRingRotate"
                                                         Storyboard.TargetProperty="Angle"
                                                         From="0"
                                                         To="360"
                                                         Duration="0:0:6"/>
                                        <DoubleAnimation Storyboard.TargetName="InstallInnerRingRotate"
                                                         Storyboard.TargetProperty="Angle"
                                                         From="360"
                                                         To="0"
                                                         Duration="0:0:4.2"/>
                                        <DoubleAnimation Storyboard.TargetName="InstallOrbitRotate"
                                                         Storyboard.TargetProperty="Angle"
                                                         From="0"
                                                         To="360"
                                                         Duration="0:0:3.1"/>
                                        <DoubleAnimation Storyboard.TargetName="InstallPulseScaleTransform"
                                                         Storyboard.TargetProperty="ScaleX"
                                                         From="1"
                                                         To="1.28"
                                                         Duration="0:0:1.2"
                                                         AutoReverse="True"/>
                                        <DoubleAnimation Storyboard.TargetName="InstallPulseScaleTransform"
                                                         Storyboard.TargetProperty="ScaleY"
                                                         From="1"
                                                         To="1.28"
                                                         Duration="0:0:1.2"
                                                         AutoReverse="True"/>
                                        <DoubleAnimation Storyboard.TargetName="InstallProgressTranslate"
                                                         Storyboard.TargetProperty="X"
                                                         From="-200"
                                                         To="200"
                                                         Duration="0:0:1.9"
                                                         AutoReverse="True"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.EnterActions>
                            <DataTrigger.ExitActions>
                                <StopStoryboard BeginStoryboardName="InstallOverlayMotionStoryboard"/>
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetName="OverlayRoot"
                                                         Storyboard.TargetProperty="Opacity"
                                                         To="0"
                                                         Duration="0:0:0.45"
                                                         EasingFunction="{StaticResource InstallOverlayEaseOut}"/>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="OverlayRoot"
                                                                       Storyboard.TargetProperty="Visibility">
                                            <DiscreteObjectKeyFrame KeyTime="0:0:0.45"
                                                                    Value="{x:Static Visibility.Collapsed}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <BooleanAnimationUsingKeyFrames Storyboard.TargetName="OverlayRoot"
                                                                        Storyboard.TargetProperty="IsHitTestVisible">
                                            <DiscreteBooleanKeyFrame KeyTime="0:0:0" Value="False"/>
                                        </BooleanAnimationUsingKeyFrames>
                                    </Storyboard>
                                </BeginStoryboard>
                            </DataTrigger.ExitActions>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </ContentControl.Template>
        </ContentControl>
    </Grid>
</Page>
