<Window x:Class="TidyWindow.App.Views.Dialogs.PendingAutomationPromptWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PulseGuard"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        SizeToContent="WidthAndHeight"
        AllowsTransparency="True"
        WindowStyle="None"
        Background="Transparent"
        Foreground="#E2E8F0"
        MinWidth="460"
        MinHeight="280"
        ShowInTaskbar="False">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <Style x:Key="PulseGuardButton" TargetType="Button" BasedOn="{x:Null}">
            <Setter Property="Foreground" Value="#E2E8F0"/>
            <Setter Property="Background" Value="#1F2A44"/>
            <Setter Property="BorderBrush" Value="#334155"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#243453"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#3B4F73"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1B2742"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PulseGuardPrimaryButton" TargetType="Button" BasedOn="{StaticResource PulseGuardButton}">
            <Setter Property="Foreground" Value="#F8FAFC"/>
            <Setter Property="Background" Value="#2563EB"/>
            <Setter Property="BorderBrush" Value="#3B82F6"/>
        </Style>

        <Style x:Key="PulseGuardGhostButton" TargetType="Button" BasedOn="{StaticResource PulseGuardButton}">
            <Setter Property="Foreground" Value="#94A3B8"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="#1E2F49"/>
        </Style>
    </Window.Resources>

    <Border Padding="0"
            BorderBrush="#1D2A44"
            BorderThickness="1"
            CornerRadius="18">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0F172A" Offset="0"/>
                <GradientStop Color="#0B1324" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <Border.Effect>
            <DropShadowEffect Color="#000000" BlurRadius="28" Opacity="0.45" ShadowDepth="0"/>
        </Border.Effect>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Border Grid.Row="0"
                    CornerRadius="18,18,0,0"
                    Background="#101A2F"
                    Padding="24,20">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#2563EB"
                            Width="12"
                            Height="12"
                            CornerRadius="6"
                            VerticalAlignment="Center"/>
                    <StackPanel Margin="12,0,0,0">
                        <TextBlock Text="PulseGuard"
                                   Foreground="#93C5FD"
                                   FontSize="12"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="Automation still running"
                                   FontSize="22"
                                   FontWeight="SemiBold"
                                   Foreground="#F8FAFC"
                                   TextWrapping="Wrap"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <StackPanel Grid.Row="1" Margin="24,16,24,24">
                <TextBlock Text="Closing TidyWindow right now can interrupt the automation tasks shown below."
                           FontSize="13"
                           Foreground="#CBD5F5"
                           TextWrapping="Wrap"
                           Margin="0,0,0,12"/>
                <TextBlock Text="PulseGuard recommends waiting until these tasks finish."
                           FontSize="13"
                           Foreground="#CBD5F5"
                           TextWrapping="Wrap"
                           Margin="0,0,0,20"/>

                <Border Background="#111C34"
                        BorderBrush="#1E2F49"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="16"
                        Margin="0,0,0,24">
                    <StackPanel>
                        <TextBlock Text="Active automation"
                                   FontSize="11"
                                   Foreground="#60A5FA"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,6"/>
                        <ItemsControl ItemsSource="{Binding WorkSummaries}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,2">
                                        <TextBlock Text="â€¢ " Foreground="#64748B" FontSize="12"/>
                                        <TextBlock Text="{Binding}"
                                                   FontSize="12"
                                                   Foreground="#9FB3FF"
                                                   TextWrapping="Wrap"
                                                   Width="360"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                        <TextBlock Text="{Binding OverflowSummary}"
                                   FontSize="11"
                                   Foreground="#94A3B8"
                                   Margin="0,8,0,0"
                                   Visibility="{Binding HasOverflow, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    </StackPanel>
                </Border>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Close anyway"
                            MinWidth="120"
                            Margin="0,0,12,0"
                            Style="{StaticResource PulseGuardPrimaryButton}"
                            Click="OnCloseAnyway"/>
                    <Button Content="Wait"
                            MinWidth="110"
                            Style="{StaticResource PulseGuardGhostButton}"
                            Click="OnWait"/>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Border>
</Window>
