Version Control Page – refined concept
-------------------------------------

Intent
- Give advanced users a single place to audit package versions, detect duplicates/mismatches, and intentionally switch versions without digging through the generic Maintenance screen.
- Reuse `PackageInventoryService` + `PackageMaintenanceService` data so the page is mostly a presentation layer plus a few extra detection steps.

Data we already have
- Inventory snapshot (`PackageInventorySnapshot`) includes manager, identifier, installed vs available version, source, catalog metadata (requires admin, tags, command).
- Maintenance VM already tracks update availability, manual-upgrade suppressions, warnings, and operations queue.

Signals to surface on the new page
1. **Version drift** – installed version ≠ highest available (inventory already flags `IsUpdateAvailable`).
2. **Multiple installs** – same package identifier detected under multiple install roots/versions. We can extend the inventory script to report duplicate display names + install locations, then group in the UI.
3. **Pinned/frozen versions** – if user set a target version (Maintenance request stores `RequestedVersion`), show the pin and offer “Clear pin”.
4. **PATH ownership** – show which package currently contributes the executable to `%PATH%` (resolve via catalog command or a new PowerShell helper that checks `where <command>` and maps back to package).

Proposed UX structure
- **Summary banner**: “X packages tracked • Y version anomalies • Z duplicate roots”. Quick actions: refresh inventory, export report.
- **Anomalies list** (default view): cards/rows grouped by package with badges (Update available, Duplicate install, Manual upgrade required, Hash mismatch). Each row shows installed vs available, install roots (Paths), manager/source, last refreshed timestamp.
- **All packages tab**: sortable grid for healthy packages too; acts as the canonical “what version is TidyWindow using?” reference.
- **History/Actions drawer**: reuse maintenance operations list so users can monitor version switch attempts without leaving the page.

Key actions per package
1. `Update to latest` → simply call existing maintenance update path.
2. `Switch version…` → prompt for version string, call maintenance with `RequestedVersion` (already supported by scripts) and mark as pinned.
3. `Set PATH ownership` → when multiple installs exist, let user choose which install root populates PATH. Implementation: new helper script updates our PATH shim or warns if manager owns it.
4. `Open install location / manifest` for quick inspection.

Implementation outline
1. **Backend contract**: extend `get-package-inventory.ps1` to emit install locations + duplicates, plus optional PATH winner info. Shape a new DTO (`VersionControlSnapshot`) that wraps the existing `PackageInventorySnapshot` and adds duplicate groupings + pin metadata.
2. **View model**: add `VersionControlViewModel` that subscribes to `PackageInventoryService` refreshes, computes anomaly groups, and exposes filterable collections (Anomalies, AllPackages, Duplicates).
3. **UI**: new `VersionControlPage.xaml` with tabs (Anomalies, All packages, Actions). Reuse Essentials/Install Hub responsive layout + virtualization. Provide per-row action buttons wired to maintenance commands.
4. **Integration**: from Maintenance page, replace the current “healthy list” with a link “Need detailed version insights? Open Version Control.” Maintenance stays focused on pending updates/removals.
5. **Telemetry & export**: optional copy/export button that dumps the snapshot to JSON so users can share audits.

Stretch ideas
- Highlight packages whose available version regressed (catalog vs installed > available) and allow “Pin to installed version”.
- Provide a diff view between two inventory snapshots to spot changes after a deployment.
- Allow tagging critical packages and surfacing them at the top when versions drift.

Result: a dedicated Version Control hub that explains “what we have installed where,” why something is out of sync, and offers purposeful fixes without overloading the Maintenance screen.