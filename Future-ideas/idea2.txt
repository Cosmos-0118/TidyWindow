Project Oblivion – popup deep clean
----------------------------------

Core promise
- Keep the UI dead simple (one page, one popup) while still deleting everything tied to an app.
- Popup should feel special—PathPilot-style animation, live logs, and user control over what gets wiped.

Data model
1. **Inventory sweep**: merge winget/choco/scoop/Appx/uninstall hives and include install roots, suspected processes/services, package family name, uninstall command, and confidence tag.
2. **Artifact hints**: pre-store likely folders/keys so the popup scan can start displaying results before the deep crawl finishes.

UI flow
1. **List page**: searchable table (Name, Version, Size, Source, Last used) with `Uninstall` button.
2. **Popup timeline**:
	- Stage 0: Kickoff screen with command preview + `Start`.
	- Stage 1: Run default uninstall, stream logs.
	- Stage 2: Process/service sweep with auto-kill + manual retry buttons.
	- Stage 3: Artifact discovery showing grouped checklists (Files, Registry, Tasks/Autoruns, Drivers, Misc) with select-all toggles.
	- Stage 4: User selection confirmation (`Remove selected` button resumes flow).
	- Stage 5: Cleanup execution with per-group progress lines.
	- Stage 6: Summary card (freed space, removed vs skipped, elapsed time, `View log`).

Deletion pipeline
1. Native uninstall command (winget/choco/scoop/msiexec/Appx). Elevate once if required.
2. Process/service sweep using module path + service bin path matching; kill or skip per user choice.
3. Artifact discovery hitting install root, ProgramData/AppData/Temp, registry keys (Uninstall, Services, Run, CLSID, App Paths), scheduled tasks, autoruns, drivers, env vars, firewall rules.
4. User-configurable removal: all items checked by default; unchecking keeps them.
5. Cleanup run deletes files/folders first, then registry, then tasks/drivers/env vars. Failures stay highlighted with retry link.

Safety/diagnostics
- No restore points or typed confirmations. Rely on the summary + stored log JSON.
- Store each run under `data/cleanup/<AppId>/oblivion-run.json` with artifacts found, selected, removed, skipped, and timings.
- Show inline error callouts if any stage fails; allow relaunch from the same popup while keeping selections.

Implementation notes
1. Extend `get-installed-app-footprint.ps1` to emit enriched metadata (install roots, service/task hints, package family, uninstall command, display info).
2. Author `uninstall-app-deep.ps1` (JSON streaming) with stages: uninstall, process sweep, artifact discovery, cleanup, summary.
3. Build `ProjectOblivionViewModel` (list) + `ProjectOblivionPopupViewModel` (timeline, checklist, summary) with an animation control shared with PathPilot.
4. Add structured telemetry hooks (stage durations, artifact counts, failures) surfaced both in Activity Log and the popup summary.

Stretch ideas
- Multi-select queue that runs popups back-to-back automatically.
- Optional leftover presets (e.g., always keep config folders) tied to user settings.